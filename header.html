<nav class="fixed top-0 left-0 w-full z-[1000] shadow-md py-3 bg-gray-900">
    <style>
        /* Prevent flash of content during auth state changes */
        .nav-link-button {
            opacity: 1;
            transition: opacity 0.3s ease-in-out;
        }
        
        /* Hide elements initially until auth state is determined */
        .auth-dependent {
            display: none;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }
        
        .auth-dependent.visible {
            opacity: 1;
            display: flex;
        }

        /* Increased spacing between profile and menu */
        .space-x-5 > * + * {
            margin-left: 1.25rem;
        }

        /* Ensure smooth transitions for auth area */
        #desktopAuthArea {
            min-height: 2.5rem; /* Prevent height collapse during transitions */
            opacity: 1 !important;
            display: flex !important;
        }

        /* Hide auth elements until Firebase is ready */
        .auth-loading * {
            visibility: hidden;
        }

        .auth-ready * {
            visibility: visible;
        }

        /* Profile icon and hamburger menu colors */
        .profile-icon-placeholder svg {
            color: white;
            width: 2rem;
            height: 2rem;
        }

        .desktop-hamburger-icon svg {
            color: white;
            width: 1.5rem;
            height: 1.5rem;
        }

        /* Auth state handling */
        #loginElements {
            display: flex;  /* Show by default for non-logged in state */
            opacity: 1;
            transition: opacity 0.3s ease-in-out;
        }

        #profileAndMenuDesktop {
            display: none;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }

        #profileAndMenuDesktop.visible {
            display: flex;
            opacity: 1;
        }

        /* Navigation links */
        .nav-link {
            color: white;
            text-decoration: none;
        }

        .nav-link:hover {
            color: #e2e8f0;
        }

        /* Prevent login button flash */
        #authLinkDesktopLogin {
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }

        #authLinkDesktopLogin.visible {
            opacity: 1;
        }

        /* Slideout menu styles */
        .slide-out-panel {
            position: fixed;
            top: 0;
            right: 0;
            width: 300px;
            height: 100vh;
            background-color: #1a202c;
            transform: translateX(100%);
            transition: transform 0.3s ease-in-out;
            z-index: 1001;
            display: none;
        }

        .slide-out-panel.active {
            transform: translateX(0);
        }

        .slide-out-panel-header {
            padding: 1rem;
            border-bottom: 1px solid #2d3748;
            display: flex;
            justify-content: flex-end;
        }

        .slide-out-panel-close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }

        .slide-out-panel-nav {
            padding: 1rem;
        }

        .slide-out-panel-nav a {
            display: block;
            padding: 0.75rem 1rem;
            color: white;
            text-decoration: none;
            transition: background-color 0.2s;
        }

        .slide-out-panel-nav a:hover {
            background-color: #2d3748;
        }

        .profile-icon {
            width: 32px;
            height: 32px;
            fill: white;
        }

        .hamburger-icon {
            width: 24px;
            height: 24px;
            stroke: white;
            cursor: pointer;
        }

        #desktop-slideout-menu {
            position: fixed;
            top: 0;
            right: 0;
            width: 300px;
            height: 100vh;
            background: #1a202c;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            z-index: 2000;
        }

        #desktop-slideout-menu.show {
            transform: translateX(0);
        }

        .slide-out-panel-nav a {
            display: block;
            color: white;
            padding: 15px 20px;
            text-decoration: none;
        }

        .slide-out-panel-nav a:hover {
            background: rgba(255, 255, 255, 0.1);
        }
    </style>
    <div class="container mx-auto px-4 sm:px-6 lg:px-8 flex justify-between items-center">
        <a href="index.html" class="text-3xl font-bold text-white">Linq</a>
        <div class="hidden md:flex items-center space-x-5">
            <a href="index.html" class="text-white text-sm">News</a>
            <a href="community.html" class="text-white text-sm">Community</a> 
            <a href="markets.html" class="text-white text-sm">Markets</a> 
            
            <!-- Not logged in state -->
            <div id="loginElements" class="flex items-center space-x-4">
                <a href="login.html" class="text-white text-sm">Login</a>
                <button onclick="window.location.href='login.html'" class="hamburger-icon">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                    </svg>
                </button>
            </div>

            <!-- Logged in state -->
            <div id="profileAndMenuDesktop" class="hidden items-center space-x-4">
                <a href="profile.html" class="profile-icon">
                    <svg viewBox="0 0 24 24">
                        <path fill="currentColor" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/>
                    </svg>
                </a>
                <button onclick="toggleMenu()" class="hamburger-icon">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                    </svg>
                </button>
            </div>
        </div>
        <div class="md:hidden">
            <button id="mobile-menu-button" class="text-gray-300 hover:text-white focus:outline-none">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                </svg>
            </button>
        </div>
    </div>
    <div id="mobile-menu" class="md:hidden hidden bg-gray-900 bg-opacity-90 backdrop-blur-md">
        <a href="login.html" id="authLinkMobile" class="block nav-link text-sm px-4 py-3 hover:bg-gray-700">Login</a>
        <a href="linqai.html" class="block nav-link text-sm px-4 py-3 hover:bg-gray-700">Linq Ai</a>
        <a href="earnings.html" class="block nav-link text-sm px-4 py-3 hover:bg-gray-700">Earnings Calendar</a>
        <a href="index.html" class="block nav-link text-sm px-4 py-3 hover:bg-gray-700">News</a> 
        <a href="community.html" class="block nav-link text-sm px-4 py-3 hover:bg-gray-700 active">Community</a> 
        <a href="Markets.html" class="block nav-link text-sm px-4 py-3 hover:bg-gray-700">Markets</a>
        <a href="favorites.html" id="favoritesLinkMobile" class="block nav-link text-sm px-4 py-3 hover:bg-gray-700 hidden">Favorites</a>
        <a href="#" id="logoutButtonMobile" class="hidden nav-link text-sm px-4 py-3 hover:bg-gray-700">Logout</a>
    </div>
</nav>

<div id="desktop-slideout-menu" class="slide-out-panel">
    <div class="slide-out-panel-header">
        <button id="slideout-close-button" class="slide-out-panel-close-btn" aria-label="Close menu">&times;</button>
    </div>
    <nav class="slide-out-panel-nav">
        <a href="linqai.html">Linq AI</a>
        <a href="earnings.html">Earnings Calendar</a>
        <a href="favorites.html">Favorites</a> 
        <a href="profile.html">My Profile</a>
        <a href="#" id="logoutButtonSlideout">Logout</a> 
    </nav>
</div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>

<script>
    // Firebase configuration
    const firebaseConfig = {
        apiKey: "AIzaSyD_FCx8sIkrCoQMoKm5xQIvlyAmlqptETk",
        authDomain: "linq-b27a8.firebaseapp.com",
        projectId: "linq-b27a8",
        storageBucket: "linq-b27a8.firebasestorage.app",
        messagingSenderId: "1067901051826",
        appId: "1:1067901051826:web:44452d1339cdbe2af07aab"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);

    function toggleMenu() {
        const menu = document.getElementById('desktop-slideout-menu');
        menu.classList.toggle('show');
    }

    function handleLogout(e) {
        e.preventDefault();
        firebase.auth().signOut().then(() => {
            window.location.href = 'index.html';
        }).catch((error) => {
            console.error('Error signing out:', error);
        });
    }

    // Update UI based on auth state
    firebase.auth().onAuthStateChanged((user) => {
        const loginElements = document.getElementById('loginElements');
        const profileMenu = document.getElementById('profileAndMenuDesktop');
        
        if (user) {
            loginElements.style.display = 'none';
            profileMenu.style.display = 'flex';
        } else {
            loginElements.style.display = 'flex';
            profileMenu.style.display = 'none';
        }
    });
</script>

